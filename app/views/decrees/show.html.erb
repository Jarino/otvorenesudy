<% provide :title, "IČS #{@decree.file_number} &middot; Súdne rozhodnutie".html_safe %>

<section id="decree-info">
  <div class="page-header">
    <h1>
      Súdne rozhodnutie
      <%= tooltip_tag @decree.file_number, "Identifikačné číslo súdneho spisu", placement: :right %>
      <br/>
      <small>
        Rozhodnutie bolo vynesené dňa &ndash;
        <%= decree_date @decree.date %>
      </small>
    </h1>
  </div>

  <div class="row">
    <div class="span8">
      <% if @court %>
        <p>Rozhodnuté bolo na súde <%= link_to_court @court %>.</p>
      <% end %>
      <% if @decree.judges.any? %>
        <p>
          Rozhodutie vydal sudca <%= links_to_judges @decree.judges %>.
        </p>
      <% end %>
      <% if @decree.legislation_area %>
        <p>
          Oblasti právnej úpravy &ndash; <%= link_to_decrees_search @decree.legislation_area.value, params: { legislation_area: @decree.legislation_area.value } %>
        <%= " &ndash; #{link_to_decrees_search @decree.legislation_subarea.value, params: { legislation_area: @decree.legislation_area.value,  legislation_subarea: @decree.legislation_subarea.value } }".html_safe if @decree.legislation_subarea %>.
        </p>
      <% end %>
      <% if @decree.form %>
        <p>Forma rozhodnutia &ndash; <%= link_to_decrees_search @decree.form.value, params: { form: @decree.form.value } %>.</p>
      <% end %>
      <% if @decree.natures.any? %>
        <p>Povaha rozhodnutia &ndash; <%= @decree.natures.map { |nature| link_to_decrees_search(nature.value, params: { natures: nature.value }) }.join(', ').html_safe %>.</p>
      <% end %>
      <% if @legislations.any? %>
        <p>Predpisy odkazované v rozhodnutí:</p>
        <ul>
          <% @legislations.each do |legislation| %>
            <li><%= external_link_to_legislation legislation %></li>
          <% end %>
        </ul>
      <% end %>
    </div>

    <div class="span4">
      <div class="well well-small">
        <p>
          <%= tooltip_tag "ECLI", "European Case Law Identifier", placement: :left %>:
          <span class="pull-right"><%= @decree.ecli %></span>
        </p>
        <p>
          <%= tooltip_tag "SZ", "Spisová značka", placement: :left %>:
          <span class="pull-right"><%= @decree.case_number %></span>
        </p>
        <p>
          <%= tooltip_tag "IČS", "Identifikačné číslo súdneho spisu", placement: :left %>:
          <span class="pull-right"><%= @decree.file_number %></span>
        </p>
      </div>
    </div>
  </div>
</section>

<section id="decree-document">
  <div class="row">
    <div class="span12">
      <!-- TODO <%= @decree.text %> -->
    </div>
  </div>
</section>

<div class="document">
</div>


<section id="decree-resource">
  <div class="row">
    <div class="span12">
      <div class="pull-right">
        <small class="muted">
          Informácie o súdnom rozhodnutí boli získané zo <%= external_link_to 'zdroja', @decree.uri, class: :muted %>,
          ktorého posledná aktualizácia bola zistená <%= time_tag @decree.updated_at.to_date, format: :default %>.
        </small>
      </div>
    </div>
  </div>
</section>

<% content_for :scripts do %>
  <script type="text/javascript" charset="utf-8">
     $(function() {
    var dv = DV.DocumentViewer.init({
      container: $('.document'),
      attachments: <%== [decree_to_document_viewer(@decree)].to_json %>,
      width: '940px',
      height: '1300px',
      annotationsAllowed: false,
      zoom: true,
      commentList: false,
      search: {
        query:    "<%= params[:q] || "" %>",
        callback: function(q, callback) {
          searchDecreePages(<%= @decree.id %>, q, callback)
        }
      }
    });
  });
  </script>
<% end %>
