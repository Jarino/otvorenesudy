<% provide :title, @court.name %>

<section id="court-profile" class="profile">
  <div class="page-header">
    <h1>
      <%= yield :title %>
      <br/>
      <small><%= @court.address %></small>
    </h1>
  </div>

  <div class="row">
    <div class="span12">
      <p>
        <span class="gutter centered"><%= icon_tag :user %></span>
        Na súde <%= @judges.any? ? 'pracuje' : 'nepracujú' %>
        <%= translate_with_count(@judges.count, :judge) %>.
        Pre súd <%= 'zatiaľ ne' if @court.hearings.none? %>evidujeme
        <%= translate_with_count(@court.hearings.count, :hearing) %>
        a&nbsp;<%= translate_with_count(@court.decrees.count, :decree) %>.
      </p>
      
      <% if @expenses.any? %>
        <p>
          <span class="gutter centered"><%= icon_tag :euro %></span>
          Celkovo <%= rank Indicator::CourtExpenses.rank @court %> najviac pokutovaný súd zo <%= Indicator::CourtExpenses.courts.count %> súdov.
        </p>

        <p>
          <span class="gutter centered"><%= icon_tag :euro %></span>
          Pokuty od Ústavného súdu Slovenskej republiky za neskoré a nesprávne rozhodnutia v rokoch
          <%= @expenses.first.year %> &ndash; <%= @expenses.last.year %>
          boli <%= number_to_currency(@court.expenses_total, precision: 0) %>.
          <% unless @court.expenses_total.zero? %>
            <ul>
              <% @expenses.reverse.reject { |expense| expense.value.zero? }.each do |expense| %>
                <li>za rok <%= expense.year %> &ndash; <%= number_to_currency expense.value, precision: 0 %></li>
              <% end %>
            </ul>
          <% end %>
        </p>
      <% end %>
    </div>
  </div>
</section>

<section id="court-tabs">
  <div class="row">
    <div class="span12">
      <div class="tabbable">
        <ul class="nav nav-tabs">
          <li class="active">
            <a href="#contact" data-toggle="tab">Kontakt</a>
          </li>
<!-- TODO rm         
          <li><a href="#offices" data-toggle="tab">Pracoviská</a></li>
-->
          <li><%= tab_link_to_with_count 'Sudcovia', '#judges', @judges.count%></li>
          <li><%= tab_link_to_with_count 'Rozhodnutia', '#decrees', @court.decrees.count %></li>
          <li><%= tab_link_to_with_count 'Pojednávania', '#hearings', @court.hearings.count %></li>
          <li><%= tab_link_to_with_count 'V médiách', '#media', @results.count %></li>
        </ul>

        <div class="tab-content">
          <div id="contact" class="tab-pane active">
            <%= render 'contact' %>
          </div>
<!-- TODO rm
          <div id="offices" class="tab-pane">
            <%= render 'offices' %>
          </div>
-->
          <div id="judges" class="tab-pane">
            <%= render 'judges', judges: @judges %>
          </div>

          <div id="decrees" class="tab-pane">
            <%= render 'decrees', decrees: @decrees, query: { court: @court.name } %>
          </div>

          <div id="hearings" class="tab-pane">
            <%= render 'hearings', hearings: @hearings, query: { court: @court.name } %>
          </div>

          <div id="media" class="tab-pane">
            <%= render 'media', results: @results %>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section id="court-resource">
  <div class="row">
    <div class="span12">
      <small class="muted">
        Informácie o súde boli získané z <%= external_link_to 'dokumentu', @court.uri, class: :muted %>,
        ktorého posledná aktualizácia bola vykonaná <%= time_tag @court.updated_at.to_date, format: :default %>.
      </small>
    </div>
  </div>
</section>
